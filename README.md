# CryptoCore

–ö–æ–º–∞–Ω–¥–Ω–∞—è —É—Ç–∏–ª–∏—Ç–∞ –¥–ª—è –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏—Ö –æ–ø–µ—Ä–∞—Ü–∏–π: —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ, –¥–µ—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ, —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ, HMAC –∏ –≤—ã—Ä–∞–±–æ—Ç–∫–∞ –∫–ª—é—á–µ–π —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º AES-128, SHA-256, SHA3-256 –∏ PBKDF2.

## –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –∏ –¥–µ—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ
- –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –∏ –¥–µ—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–æ–≤ —Å –ø–æ–º–æ—â—å—é AES-128
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ä–µ–∂–∏–º–æ–≤: ECB, CBC, CFB, OFB, CTR, GCM
- AEAD —Ä–µ–∂–∏–º—ã —Å –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–µ–π: GCM –∏ Encrypt-then-MAC
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–ª—é—á–µ–π –ø—Ä–∏ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–∏
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –∏ —É–¥–∞–ª–µ–Ω–∏–µ padding –ø–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç—É PKCS#7 (–¥–ª—è ECB, CBC)
- –ü–æ—Ç–æ–∫–æ–≤—ã–µ —Ä–µ–∂–∏–º—ã –±–µ–∑ padding (CFB, OFB, CTR, GCM)
- –†–∞–±–æ—Ç–∞ —Å –±–∏–Ω–∞—Ä–Ω—ã–º–∏ –∏ —Ç–µ–∫—Å—Ç–æ–≤—ã–º–∏ —Ñ–∞–π–ª–∞–º–∏
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è IV/nonce –∏ –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –≤–Ω–µ—à–Ω–∏—Ö IV

### –•–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ
- –í—ã—á–∏—Å–ª–µ–Ω–∏–µ –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏—Ö —Ö–µ—à–µ–π SHA-256 –∏ SHA3-256
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏ —Ñ–∞–π–ª–æ–≤
- –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–º–∏ —É—Ç–∏–ª–∏—Ç–∞–º–∏

### –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è —Å–æ–æ–±—â–µ–Ω–∏–π (HMAC)
- HMAC-SHA-256 —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è —Å –Ω—É–ª—è —Å–æ–≥–ª–∞—Å–Ω–æ RFC 2104
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∫–ª—é—á–µ–π –ª—é–±–æ–π –¥–ª–∏–Ω—ã
- –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ —Ñ–∞–π–ª–∞—Ö –∏ –ø–æ–¥–º–µ–Ω—ã –∫–ª—é—á–µ–π
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ Encrypt-then-MAC AEAD —Ä–µ–∂–∏–º

### –§—É–Ω–∫—Ü–∏–∏ –≤—ã—Ä–∞–±–æ—Ç–∫–∏ –∫–ª—é—á–µ–π (KDF)
- PBKDF2-HMAC-SHA256 - Password-Based Key Derivation Function 2
- HKDF –∏ –∏–µ—Ä–∞—Ä—Ö–∏—è –∫–ª—é—á–µ–π - HMAC-based Key Derivation Function
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–æ–ª–µ–π - –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–∞—è
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ - –¥–ª–∏–Ω–∞ –ø–∞—Ä–æ–ª—è, —Å–æ–ª–∏, –∏—Ç–µ—Ä–∞—Ü–∏–π, –∫–ª—é—á–∞

### –û–±—â–∏–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏
- –ö—Ä–æ—Å—Å–ø–ª–∞—Ç—Ñ–æ—Ä–º–µ–Ω–Ω–∞—è —Å–±–æ—Ä–∫–∞ (Windows, Linux, macOS)
- –ü–æ–¥—Ä–æ–±–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –∏ –≤–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- –ê–≤—Ç–æ–≥–µ–Ω–µ—Ä–∞—Ü–∏—è –∏–º–µ–Ω –≤—ã—Ö–æ–¥–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤
- –ü–æ–ª–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å OpenSSL –∏ Python hashlib
- –ö—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω—ã–π –ì–°–ß (CSPRNG)
- –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –ø–µ—Ä–µ–¥ –¥–µ—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ–º
- –ó–∞—â–∏—Ç–∞ –æ—Ç –ø–æ–¥–¥–µ–ª–∫–∏ —à–∏—Ñ—Ä–æ—Ç–µ–∫—Å—Ç–∞

## –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ —Å–±–æ—Ä–∫–µ

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Git - [–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å Git](https://git-scm.com/downloads)
- Go 1.25.1+ - [–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å Golang](https://go.dev/doc/install)

### –°–±–æ—Ä–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞

```bash
# –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
git clone https://github.com/kokinf/CryptoCore
cd CryptoCore

# –°–±–æ—Ä–∫–∞ –¥–ª—è linux –∏ macOS
make build

# –°–±–æ—Ä–∫–∞ –¥–ª—è Windows
go build -o cryptocore.exe ./src
```

## –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

- **Go 1.25+** - —è–∑—ã–∫ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è –∏ —Å—Ä–µ–¥–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
- **–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ Go** - –≤–Ω–µ—à–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –Ω–µ —Ç—Ä–µ–±—É—é—Ç—Å—è
- **OpenSSL** (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) - –¥–ª—è –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –ë–∞–∑–æ–≤–æ–µ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –∏ –¥–µ—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ

```bash
# –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –≥–µ–Ω–µ—Ä–∞—Ü–∏–µ–π –∫–ª—é—á–∞
./cryptocore --algorithm aes --mode cbc --encrypt --input secret.txt --output ciphertext.bin

# –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–∞ –≤ —Ä–µ–∂–∏–º–µ ECB
./cryptocore --algorithm aes --mode ecb --encrypt \
  --key 000102030405060708090a0b0c0d0e0f \
  --input secret.txt --output ciphertext.bin

# –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–∞ –≤ —Ä–µ–∂–∏–º–µ CBC (IV –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)
./cryptocore --algorithm aes --mode cbc --encrypt \
  --key 000102030405060708090a0b0c0d0e0f \
  --input secret.txt --output ciphertext.bin

# –î–µ—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–∞ —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º —á—Ç–µ–Ω–∏–µ–º IV –∏–∑ —Ñ–∞–π–ª–∞
./cryptocore --algorithm aes --mode cbc --decrypt \
  --key 000102030405060708090a0b0c0d0e0f \
  --input ciphertext.bin --output decrypted.txt

# –î–µ—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ —Å —É–∫–∞–∑–∞–Ω–∏–µ–º IV
./cryptocore --algorithm aes --mode cbc --decrypt \
  --key 000102030405060708090a0b0c0d0e0f \
  --iv aabbccddeeff00112233445566778899 \
  --input ciphertext.bin --output decrypted.txt
```

### AEAD —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ (GCM –∏ Encrypt-then-MAC)

#### GCM (Galois/Counter Mode):
```bash
# –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ GCM —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –≥–µ–Ω–µ—Ä–∞—Ü–∏–µ–π –∫–ª—é—á–∞
./cryptocore --algorithm aes --mode gcm --encrypt \
  --input secret.txt --output encrypted.gcm
# –ó–∞–ø–∏—à–∏—Ç–µ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∫–ª—é—á!

# –î–µ—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ GCM
./cryptocore --algorithm aes --mode gcm --decrypt \
  --key –°–ì–ï–ù–ï–†–ò–†–û–í–ê–ù–ù–´–ô_–ö–õ–Æ–ß \
  --input encrypted.gcm --output decrypted.txt

# GCM —Å AAD (Additional Authenticated Data)
./cryptocore --algorithm aes --mode gcm --encrypt \
  --key 00112233445566778899aabbccddeeff \
  --input document.pdf --output document.gcm \
  --aad "aabbccddeeff"

# –î–µ—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ —Å —Ç–µ–º –∂–µ AAD
./cryptocore --algorithm aes --mode gcm --decrypt \
  --key 00112233445566778899aabbccddeeff \
  --input document.gcm --output document_decrypted.pdf \
  --aad "aabbccddeeff"
```

#### Encrypt-then-MAC (—Ç—Ä–µ–±—É–µ—Ç—Å—è 48-–±–∞–π—Ç–Ω—ã–π –∫–ª—é—á):
```bash
# 48-–±–∞–π—Ç–Ω—ã–π –∫–ª—é—á –¥–ª—è ETM
ETM_KEY="00112233445566778899aabbccddeeff0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1fff"

# –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ ETM –≤ —Ä–µ–∂–∏–º–µ CBC
./cryptocore --algorithm aes --mode cbc --encrypt \
  --key $ETM_KEY \
  --input sensitive.docx --output encrypted.etm

# –î–µ—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ ETM
./cryptocore --algorithm aes --mode cbc --decrypt \
  --key $ETM_KEY \
  --input encrypted.etm --output decrypted.docx

# ETM —Å AAD
./cryptocore --algorithm aes --mode ctr --encrypt \
  --key $ETM_KEY \
  --input backup.tar --output backup.etm \
  --aad "aabbccddeeff"
```

### –•–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–æ–≤

```bash
# –ë–∞–∑–æ–≤–æ–µ —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ
./cryptocore dgst --algorithm sha256 --input document.pdf

# –•–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –≤ —Ñ–∞–π–ª
./cryptocore dgst --algorithm sha3-256 --input backup.tar --output backup.sha3
```

### –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è —Å–æ–æ–±—â–µ–Ω–∏–π (HMAC)

```bash
# –ì–µ–Ω–µ—Ä–∞—Ü–∏—è HMAC
./cryptocore dgst --algorithm sha256 --hmac --key 00112233445566778899aabbccddeeff --input message.txt

# –ì–µ–Ω–µ—Ä–∞—Ü–∏—è HMAC —Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –≤ —Ñ–∞–π–ª
./cryptocore dgst --algorithm sha256 --hmac --key 00112233445566778899aabbccddeeff --input message.txt --output message.hmac

# –í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è HMAC
./cryptocore dgst --algorithm sha256 --hmac --key 00112233445566778899aabbccddeeff --input message.txt --verify expected.hmac
# –í—ã–≤–æ–¥: [OK] HMAC verification successful
```

### –í—ã—Ä–∞–±–æ—Ç–∫–∞ –∫–ª—é—á–µ–π (PBKDF2-HMAC-SHA256)

```bash
# –ë–∞–∑–æ–≤–∞—è –≤—ã—Ä–∞–±–æ—Ç–∫–∞ –∫–ª—é—á–∞ —Å —É–∫–∞–∑–∞–Ω–Ω–æ–π —Å–æ–ª—å—é
./cryptocore derive --password "MySecurePassword123!" \
  --salt a1b2c3d4e5f601234567890123456789 \
  --iterations 100000 \
  --length 32

# –í—ã—Ä–∞–±–æ—Ç–∫–∞ –∫–ª—é—á–∞ —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –≥–µ–Ω–µ—Ä–∞—Ü–∏–µ–π —Å–æ–ª–∏
./cryptocore derive --password "AnotherPassword" \
  --iterations 500000 \
  --length 16

# –í—ã—Ä–∞–±–æ—Ç–∫–∞ –∫–ª—é—á–∞ –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ —Ñ–∞–π–ª
./cryptocore derive --password "app_key" \
  --salt fixedappsalt \
  --iterations 10000 \
  --length 32 \
  --output app_key.bin

# –ü—Ä–æ–≤–µ—Ä–∫–∞ RFC 6070 —Ç–µ—Å—Ç–æ–≤—ã—Ö –≤–µ–∫—Ç–æ—Ä–æ–≤ (SHA-256 –≤–µ—Ä—Å–∏—è)
./cryptocore derive --password "password" \
  --salt 73616c74 \
  --iterations 1 \
  --length 20
# –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç: 120fb6cffcf8b32c43e7225256c4f837a86548c9 73616c74
```

## –§—É–Ω–∫—Ü–∏–∏ –≤—ã—Ä–∞–±–æ—Ç–∫–∏ –∫–ª—é—á–µ–π

### PBKDF2-HMAC-SHA256
–†–µ–∞–ª–∏–∑–∞—Ü–∏—è Password-Based Key Derivation Function 2 —Å–æ–≥–ª–∞—Å–Ω–æ RFC 2898 —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º HMAC-SHA256 –≤ –∫–∞—á–µ—Å—Ç–≤–µ –ø—Å–µ–≤–¥–æ—Å–ª—É—á–∞–π–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–∏.

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- –ü–æ–ª–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å Python `hashlib.pbkdf2_hmac('sha256', ...)`
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã—Ö –¥–ª–∏–Ω –ø–∞—Ä–æ–ª—è, —Å–æ–ª–∏ –∏ –∫–ª—é—á–∞
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–ª—É—á–∞–π–Ω–æ–π 16-–±–∞–π—Ç–Ω–æ–π —Å–æ–ª–∏
- –í–∞–ª–∏–¥–∞—Ü–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ (–∏—Ç–µ—Ä–∞—Ü–∏–∏ ‚â• 1000, –¥–ª–∏–Ω–∞ –ø–∞—Ä–æ–ª—è ‚â• 8 —Å–∏–º–≤–æ–ª–æ–≤)
- –û—á–∏—Å—Ç–∫–∞ —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –∏–∑ –ø–∞–º—è—Ç–∏

**–ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:**
```bash
# –ë–∞–∑–æ–≤—ã–π –ø—Ä–∏–º–µ—Ä: 32-–±–∞–π—Ç–Ω—ã–π –∫–ª—é—á, 100000 –∏—Ç–µ—Ä–∞—Ü–∏–π
./cryptocore derive --password "StrongPassword123" \
  --salt "deadbeefcafebabe0123456789abcdef" \
  --iterations 100000 \
  --length 32

# –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–æ–ª–∏
./cryptocore derive --password "AnotherPassword" \
  --iterations 500000 \
  --length 16

# –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∫–ª—é—á–∞ –≤ —Ñ–∞–π–ª
./cryptocore derive --password "database_encryption_key" \
  --salt "db_salt_1234567890" \
  --iterations 200000 \
  --length 32 \
  --output db_key.bin
```

### –ò–µ—Ä–∞—Ä—Ö–∏—è –∫–ª—é—á–µ–π (HKDF-—Å—Ç–∏–ª—å)
–§—É–Ω–∫—Ü–∏—è –¥–ª—è –¥–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –≤—ã—Ä–∞–±–æ—Ç–∫–∏ –º–Ω–æ–∂–µ—Å—Ç–≤–∞ –∫–ª—é—á–µ–π –∏–∑ –æ–¥–Ω–æ–≥–æ –º–∞—Å—Ç–µ—Ä-–∫–ª—é—á–∞:

```bash
# –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤ –∫–æ–¥:
import "cryptocore/src/kdf"

masterKey := []byte("master-key-32-bytes-123456789012")

// –í—ã–≤–æ–¥ –∫–ª—é—á–∞ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è
encryptionKey, _ := kdf.DeriveKey(masterKey, "encryption", 32)

// –í—ã–≤–æ–¥ –∫–ª—é—á–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
authKey, _ := kdf.DeriveKey(masterKey, "authentication", 32)

// –í—ã–≤–æ–¥ –∫–ª—é—á–∞ –¥–ª—è IV –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏
ivKey, _ := kdf.DeriveKey(masterKey, "iv_generation", 16)
```

**–ü—Ä–∏–Ω—Ü–∏–ø —Ä–∞–±–æ—Ç—ã:**
```
DerivedKey = HMAC-SHA256(master_key, context || counter)
```

### –ü–æ–¥–¥–µ—Ä–∂–∫–∞ AEAD –∫–ª—é—á–µ–π
–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å AEAD —Ä–µ–∂–∏–º–∞–º–∏ –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –≤—ã—Ä–∞–±–æ—Ç–∫–∏ encryption_key –∏ mac_key:

```go
// –î–ª—è Encrypt-then-MAC: 48 –±–∞–π—Ç (16 + 32)
encKey, macKey, err := kdf.DeriveAEADKeys(masterKey, 48)

// –î–ª—è GCM: 16, 24 –∏–ª–∏ 32 –±–∞–π—Ç–∞
gcmKey, _, err := kdf.DeriveAEADKeys(masterKey, 16)
```

## –ê—Ä–≥—É–º–µ–Ω—Ç—ã –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏ –¥–ª—è KDF

| –ê—Ä–≥—É–º–µ–Ω—Ç | –û–ø–∏—Å–∞–Ω–∏–µ | –ü—Ä–∏–º–µ—Ä | –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π |
|----------|-----------|---------|--------------|
| `--password` | –ü–∞—Ä–æ–ª—å –¥–ª—è –≤—ã—Ä–∞–±–æ—Ç–∫–∏ –∫–ª—é—á–∞ | `--password "MyPassword123"` | –î–∞ |
| `--salt` | –°–æ–ª—å –≤ hex-—Ñ–æ—Ä–º–∞—Ç–µ | `--salt a1b2c3d4e5f60123` | –ù–µ—Ç (–∞–≤—Ç–æ–≥–µ–Ω–µ—Ä–∞—Ü–∏—è) |
| `--iterations` | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏—Ç–µ—Ä–∞—Ü–∏–π PBKDF2 | `--iterations 100000` | –ù–µ—Ç (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: 100000) |
| `--length` | –î–ª–∏–Ω–∞ –∫–ª—é—á–∞ –≤ –±–∞–π—Ç–∞—Ö | `--length 32` | –ù–µ—Ç (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: 32) |
| `--algorithm` | –ê–ª–≥–æ—Ä–∏—Ç–º KDF | `--algorithm pbkdf2` | –ù–µ—Ç (—Ç–æ–ª—å–∫–æ pbkdf2) |
| `--output` | –í—ã—Ö–æ–¥–Ω–æ–π —Ñ–∞–π–ª –¥–ª—è –∫–ª—é—á–∞ | `--output key.bin` | –ù–µ—Ç |

**–§–æ—Ä–º–∞—Ç –≤—ã–≤–æ–¥–∞:**
```
KEY_HEX SALT_HEX
```

**–ü—Ä–∏–º–µ—Ä –≤—ã–≤–æ–¥–∞:**
```
4cd8b5c46aee47f0d4a6a0dd7c205b1d30b54d2503c13fe7422e95ea312b7425 1234567890abcdef
```

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ KDF —Ñ—É–Ω–∫—Ü–∏–π

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ —Å Python
```bash
# –¢–µ—Å—Ç 1: password='password', salt='salt', iterations=1, dklen=20
./cryptocore derive --password "password" \
  --salt 73616c74 \
  --iterations 1 \
  --length 20
# Python: 120fb6cffcf8b32c43e7225256c4f837a86548c9

# –¢–µ—Å—Ç 2: password='password', salt='salt', iterations=2, dklen=20
./cryptocore derive --password "password" \
  --salt 73616c74 \
  --iterations 2 \
  --length 20
# Python: ae4d0c95af6b46d32d0adff928f06dd02a303f8e

# –¢–µ—Å—Ç 3: password='test', salt='1234567890abcdef', iterations=1000, dklen=32
./cryptocore derive --password "test" \
  --salt 1234567890abcdef \
  --iterations 1000 \
  --length 32
# Python: 4cd8b5c46aee47f0d4a6a0dd7c205b1d30b54d2503c13fe7422e95ea312b7425
```

### –ó–∞–ø—É—Å–∫ –∫–æ–º–ø–ª–µ–∫—Å–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤
```bash
cd tests

# –¢–µ—Å—Ç—ã PBKDF2 —Å –ø—Ä–æ–≤–µ—Ä–µ–Ω–Ω—ã–º–∏ –≤–µ–∫—Ç–æ—Ä–∞–º–∏
go run test_pbkdf2_vectors.go

# –ö–æ–º–ø–ª–µ–∫—Å–Ω—ã–µ —Ç–µ—Å—Ç—ã KDF —Ñ—É–Ω–∫—Ü–∏–π
go run test_kdf_comprehensive.go
```

**–¢–µ—Å—Ç–æ–≤–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ –≤–∫–ª—é—á–∞–µ—Ç:**
- RFC 6070 —Ç–µ—Å—Ç–æ–≤—ã–µ –≤–µ–∫—Ç–æ—Ä—ã (–∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–ª—è SHA-256)
- –î–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ—Å—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
- –†–∞–∑–ª–∏—á–Ω—ã–µ –¥–ª–∏–Ω—ã –∫–ª—é—á–µ–π (1-128 –±–∞–π—Ç)
- –£–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç—å —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Å–æ–ª–µ–π (100+ —Ç–µ—Å—Ç–æ–≤)
- –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –∫–ª—é—á–µ–π –ø–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞–º
- –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å (1000-50000 –∏—Ç–µ—Ä–∞—Ü–∏–π)
- –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å Python hashlib

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å Python
```python
# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏
import hashlib
import binascii

password = b'test'
salt = binascii.unhexlify('1234567890abcdef')
dk = hashlib.pbkdf2_hmac('sha256', password, salt, 1000, dklen=32)
print('Python:', binascii.hexlify(dk).decode())
# –†–µ–∑—É–ª—å—Ç–∞—Ç: 4cd8b5c46aee47f0d4a6a0dd7c205b1d30b54d2503c13fe7422e95ea312b7425
```

## –ê—Ä–≥—É–º–µ–Ω—Ç—ã –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏ –¥–ª—è AEAD

### –û–±—â–∏–µ –∞—Ä–≥—É–º–µ–Ω—Ç—ã —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è/–¥–µ—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è

| –ê—Ä–≥—É–º–µ–Ω—Ç | –û–ø–∏—Å–∞–Ω–∏–µ | –ü—Ä–∏–º–µ—Ä |
|----------|-----------|---------|
| `--algorithm` | –ê–ª–≥–æ—Ä–∏—Ç–º —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è | `--algorithm aes` |
| `--mode` | –†–µ–∂–∏–º —Ä–∞–±–æ—Ç—ã | `--mode gcm`, `--mode ctr` |
| `--encrypt` | –†–µ–∂–∏–º —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è | `--encrypt` |
| `--decrypt` | –†–µ–∂–∏–º –¥–µ—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è | `--decrypt` |
| `--key` | –ö–ª—é—á —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è | `--key 0011...0e0f` (16 –±–∞–π—Ç)<br>`--key 0011...1e1f` (48 –±–∞–π—Ç –¥–ª—è ETM) |
| `--input` | –í—Ö–æ–¥–Ω–æ–π —Ñ–∞–π–ª | `--input data.txt` |
| `--output` | –í—ã—Ö–æ–¥–Ω–æ–π —Ñ–∞–π–ª | `--output result.bin` |
| `--iv` | –í–µ–∫—Ç–æ—Ä –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ | `--iv aabb...8899` (16 –±–∞–π—Ç –¥–ª—è CBC/CFB/OFB/CTR)<br>`--iv aabb...4455` (12 –±–∞–π—Ç –¥–ª—è GCM) |
| `--aad` | –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (hex) | `--aad 757365723a616c696365` |

*–¢—Ä–µ–±—É–µ—Ç—Å—è —É–∫–∞–∑–∞—Ç—å —Ä–æ–≤–Ω–æ –æ–¥–∏–Ω –∏–∑ —Ñ–ª–∞–≥–æ–≤ `--encrypt` –∏–ª–∏ `--decrypt` –¥–ª—è –æ–ø–µ—Ä–∞—Ü–∏–π —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è*

### –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ AEAD —Ä–µ–∂–∏–º–æ–≤:

#### –î–ª—è GCM:
- `--key`: 16, 24 –∏–ª–∏ 32 –±–∞–π—Ç–∞
- `--iv` (nonce): 12 –±–∞–π—Ç (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è), –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
- `--aad`: –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω–∞—è –¥–ª–∏–Ω–∞, –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ
- **–§–æ—Ä–º–∞—Ç —Ñ–∞–π–ª–∞**: `[12 –±–∞–π—Ç nonce][—à–∏—Ñ—Ä–æ—Ç–µ–∫—Å—Ç][16 –±–∞–π—Ç —Ç–µ–≥]`

#### –î–ª—è Encrypt-then-MAC:
- `--key`: 48 –±–∞–π—Ç (16 –¥–ª—è —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è + 32 –¥–ª—è MAC)
- `--mode`: –ª—é–±–æ–π —Ä–µ–∂–∏–º –∫—Ä–æ–º–µ GCM (CBC, CTR, CFB, OFB, ECB)
- `--aad`: –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω–∞—è –¥–ª–∏–Ω–∞, –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ
- **–§–æ—Ä–º–∞—Ç —Ñ–∞–π–ª–∞**: `[16 –±–∞–π—Ç IV][—à–∏—Ñ—Ä–æ—Ç–µ–∫—Å—Ç][32 –±–∞–π—Ç HMAC-SHA256]` (–∫—Ä–æ–º–µ ECB)

### –•–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ (–ø–æ–¥–∫–æ–º–∞–Ω–¥–∞ dgst)

| –ê—Ä–≥—É–º–µ–Ω—Ç | –û–ø–∏—Å–∞–Ω–∏–µ | –ü—Ä–∏–º–µ—Ä |
|----------|-----------|---------|
| `--algorithm` | –ê–ª–≥–æ—Ä–∏—Ç–º —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è | `--algorithm sha256`, `--algorithm sha3-256` |
| `--input` | –í—Ö–æ–¥–Ω–æ–π —Ñ–∞–π–ª | `--input document.pdf` |
| `--output` | –í—ã—Ö–æ–¥–Ω–æ–π —Ñ–∞–π–ª (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) | `--output checksum.sha256` |

### HMAC (–ø–æ–¥–∫–æ–º–∞–Ω–¥–∞ dgst)

| –ê—Ä–≥—É–º–µ–Ω—Ç | –û–ø–∏—Å–∞–Ω–∏–µ | –ü—Ä–∏–º–µ—Ä |
|----------|-----------|---------|
| `--hmac` | –í–∫–ª—é—á–∏—Ç—å —Ä–µ–∂–∏–º HMAC | `--algorithm sha256 --hmac` |
| `--key` | –ö–ª—é—á HMAC –≤ hex-—Ñ–æ—Ä–º–∞—Ç–µ (–æ–±—è–∑–∞—Ç–µ–ª–µ–Ω) | `--key 00112233445566778899aabbccddeeff` |
| `--verify` | –§–∞–π–ª —Å –æ–∂–∏–¥–∞–µ–º—ã–º HMAC –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ | `--verify expected.hmac` |

## –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ —Ä–∞–±–æ—Ç—ã —Å –∫–ª—é—á–∞–º–∏

- **–ü—Ä–∏ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–∏**: –∞—Ä–≥—É–º–µ–Ω—Ç `--key` —è–≤–ª—è–µ—Ç—Å—è –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–º. –ï—Å–ª–∏ –∫–ª—é—á –Ω–µ —É–∫–∞–∑–∞–Ω, –±—É–¥–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏ —Å—Ç–æ–π–∫–∏–π 16-–±–∞–π—Ç–Ω—ã–π –∫–ª—é—á –∏ –≤—ã–≤–µ–¥–µ–Ω –≤ –∫–æ–Ω—Å–æ–ª—å
- **–ü—Ä–∏ –¥–µ—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–∏**: –∞—Ä–≥—É–º–µ–Ω—Ç `--key` —è–≤–ª—è–µ—Ç—Å—è –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–º
- **–§–æ—Ä–º–∞—Ç –∫–ª—é—á–∞**: 32 —Å–∏–º–≤–æ–ª–∞ –≤ —à–µ—Å—Ç–Ω–∞–¥—Ü–∞—Ç–µ—Ä–∏—á–Ω–æ–º —Ñ–æ—Ä–º–∞—Ç–µ (16 –±–∞–π—Ç) –∏–ª–∏ 96 —Å–∏–º–≤–æ–ª–æ–≤ (48 –±–∞–π—Ç –¥–ª—è ETM)
- **ETM —Ä–µ–∂–∏–º**: –∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ —É–∫–∞–∑–∞–Ω–∏–∏ 48-–±–∞–π—Ç–Ω–æ–≥–æ –∫–ª—é—á–∞

### HMAC
- **–ö–ª—é—á –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω**: –ø—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ `--hmac` –∞—Ä–≥—É–º–µ–Ω—Ç `--key` –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω
- **–õ—é–±–∞—è –¥–ª–∏–Ω–∞**: HMAC –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –∫–ª—é—á–∏ –ª—é–±–æ–π –¥–ª–∏–Ω—ã (–æ—Ç 1 –±–∞–π—Ç–∞)

## –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–ª—é—á–µ–π

–ü—Ä–∏ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–∏ –±–µ–∑ —É–∫–∞–∑–∞–Ω–∏—è –∫–ª—é—á–∞ —É—Ç–∏–ª–∏—Ç–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏ —Å—Ç–æ–π–∫–∏–π –∫–ª—é—á:

```bash
./cryptocore --algorithm aes --mode gcm --encrypt --input data.txt --output encrypted.bin

–í—ã–≤–æ–¥ –ø–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:
# –ö–ª—é—á –Ω–µ —É–∫–∞–∑–∞–Ω, –±—É–¥–µ—Ç —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
# –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∫–ª—é—á: 6e420871b65f5404cd7fdee5c82bb4e9
# GCM encryption completed with nonce: aabbccddeeff001122334455
# Operation completed successfully: data.txt -> encrypted.bin

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –∫–ª—é—á–∞ –¥–ª—è –¥–µ—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è
./cryptocore --algorithm aes --mode gcm --decrypt \
  --key 6e420871b65f5404cd7fdee5c82bb4e9 \
  --input encrypted.bin --output decrypted.txt
```

## AEAD —Ä–µ–∂–∏–º—ã —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è

### GCM (Galois/Counter Mode)
- **–°—Ç–∞–Ω–¥–∞—Ä—Ç**: NIST SP 800-38D
- **–¢–∏–ø**: AEAD (–∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ)
- **Nonce**: 12 –±–∞–π—Ç (–≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è —Å–ª—É—á–∞–π–Ω–æ)
- **–¢–µ–≥ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏**: 16 –±–∞–π—Ç
- **AAD**: –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å**: –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–∞—è –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç—å –∏ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
- **–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç—å**: –Ω–µ —Ç—Ä–µ–±—É–µ—Ç padding, –ø–æ—Ç–æ–∫–æ–≤—ã–π —Ä–µ–∂–∏–º

### Encrypt-then-MAC
- **–ü–∞—Ä–∞–¥–∏–≥–º–∞**: —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –∑–∞—Ç–µ–º MAC
- **–ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã**: –ª—é–±–æ–π —Ä–µ–∂–∏–º —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è + HMAC-SHA256
- **–ö–ª—é—á**: 48 –±–∞–π—Ç (16 –¥–ª—è —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è, 32 –¥–ª—è MAC)
- **–¢–µ–≥ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏**: 32 –±–∞–π—Ç–∞ HMAC-SHA256
- **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å**: –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è –ø–µ—Ä–µ–¥ –¥–µ—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ–º
- **–ì–∏–±–∫–æ—Å—Ç—å**: —Ä–∞–±–æ—Ç–∞–µ—Ç —Å –ª—é–±—ã–º —Ä–µ–∂–∏–º–æ–º —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è

### ECB (Electronic Codebook)
- –ö–∞–∂–¥—ã–π –±–ª–æ–∫ —à–∏—Ñ—Ä—É–µ—Ç—Å—è –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ
- –ü—Ä–æ—Å—Ç–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è
- –ü–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è —Å–ª—É—á–∞–π–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- **–í–Ω–∏–º–∞–Ω–∏–µ**: –ù–µ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–ª—è —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –∏–∑-–∑–∞ —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π –∫ –∞–Ω–∞–ª–∏–∑—É —à–∞–±–ª–æ–Ω–æ–≤
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç padding PKCS#7

### CBC (Cipher Block Chaining)
- –ö–∞–∂–¥—ã–π –±–ª–æ–∫ XOR–∏—Ç—Å—è —Å –ø—Ä–µ–¥—ã–¥—É—â–∏–º —à–∏—Ñ—Ä–æ—Ç–µ–∫—Å—Ç–æ–º
- –ü–æ–≤—ã—à–µ–Ω–Ω–∞—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –ø–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é —Å ECB
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç padding PKCS#7
- –¢—Ä–µ–±—É–µ—Ç IV (–≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–∏)

### CFB (Cipher Feedback)
- –†–µ–∂–∏–º –ø–æ—Ç–æ–∫–æ–≤–æ–≥–æ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è
- –ù–µ —Ç—Ä–µ–±—É–µ—Ç padding
- –°–∞–º–æ—Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É—é—â–∏–π—Å—è
- –¢—Ä–µ–±—É–µ—Ç IV

### OFB (Output Feedback)
- –†–µ–∂–∏–º –ø–æ—Ç–æ–∫–æ–≤–æ–≥–æ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è  
- –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç keystream –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç –¥–∞–Ω–Ω—ã—Ö
- –ù–µ —Ç—Ä–µ–±—É–µ—Ç padding
- –¢—Ä–µ–±—É–µ—Ç IV

### CTR (Counter)
- –†–µ–∂–∏–º –ø–æ—Ç–æ–∫–æ–≤–æ–≥–æ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç —Å—á–µ—Ç—á–∏–∫ –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ keystream
- –ù–µ —Ç—Ä–µ–±—É–µ—Ç padding
- –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏
- –¢—Ä–µ–±—É–µ—Ç IV/nonce

## –ê–ª–≥–æ—Ä–∏—Ç–º—ã —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è

### SHA-256
- **–°—Ç–∞–Ω–¥–∞—Ä—Ç**: NIST FIPS 180-4
- **–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞**: Merkle-Damg√•rd
- **–†–∞–∑–º–µ—Ä –±–ª–æ–∫–∞**: 512 –±–∏—Ç
- **–†–∞–∑–º–µ—Ä —Ö–µ—à–∞**: 256 –±–∏—Ç (32 –±–∞–π—Ç–∞)

### SHA3-256
- **–°—Ç–∞–Ω–¥–∞—Ä—Ç**: NIST FIPS 202
- **–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞**: Keccak sponge
- **–†–∞–∑–º–µ—Ä —Å–æ—Å—Ç–æ—è–Ω–∏—è**: 1600 –±–∏—Ç
- **–†–∞–∑–º–µ—Ä —Ö–µ—à–∞**: 256 –±–∏—Ç (32 –±–∞–π—Ç–∞)

### HMAC-SHA-256
- **–°—Ç–∞–Ω–¥–∞—Ä—Ç**: RFC 2104 –∏ RFC 4231
- **–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞**: HMAC(K, m) = H((K ‚äï opad) ‚à• H((K ‚äï ipad) ‚à• m))
- **–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç**: –∫–ª—é—á–∏ –ª—é–±–æ–π –¥–ª–∏–Ω—ã
- **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å**: constant-time —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ –¥–ª—è –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏
- **–¢–µ—Å—Ç-–≤–µ–∫—Ç–æ—Ä—ã**: –ü–æ–ª–Ω–æ—Å—Ç—å—é —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç RFC 4231
- **üÜï –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ**: –∫–∞–∫ —á–∞—Å—Ç—å Encrypt-then-MAC AEAD

## –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏ AEAD

### GCM —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è:
- **GF(2^128) —É–º–Ω–æ–∂–µ–Ω–∏–µ**: –ø–æ–ª–∏–Ω–æ–º x^128 + x^7 + x^2 + x + 1
- **GHASH**: –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è —á–µ—Ä–µ–∑ —É–º–Ω–æ–∂–µ–Ω–∏–µ –≤ –ø–æ–ª–µ –ì–∞–ª—É–∞
- **GCTR**: CTR mode –¥–ª—è —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è
- **–ü—Ä–µ–¥–≤—ã—á–∏—Å–ª–µ–Ω–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã**: –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
- **Constant-time —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ**: –∑–∞—â–∏—Ç–∞ –æ—Ç timing-–∞—Ç–∞–∫

### Encrypt-then-MAC:
- **–†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –∫–ª—é—á–µ–π**: KDF –¥–ª—è –≤—ã–≤–æ–¥–∞ encryption_key –∏ mac_key
- **–ü–æ—Ä—è–¥–æ–∫ –æ–ø–µ—Ä–∞—Ü–∏–π**: —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ ‚Üí MAC ‚Üí –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è ‚Üí –¥–µ—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ
- **–ó–∞—â–∏—Ç–∞**: –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è MAC –ø–µ—Ä–µ–¥ –¥–µ—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ–º
- **–ì–∏–±–∫–æ—Å—Ç—å**: –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –≤—Å–µ—Ö —Ä–µ–∂–∏–º–æ–≤ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è

## –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏ KDF

### PBKDF2-HMAC-SHA256 —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è:
- **–°—Ç–∞–Ω–¥–∞—Ä—Ç**: RFC 2898 –∏ RFC 6070 (–∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞–Ω–æ –¥–ª—è SHA-256)
- **–ê–ª–≥–æ—Ä–∏—Ç–º**: PBKDF2(P, S, c, dkLen) = T1 || T2 || ... || Tdklen/hLen
- **PRF**: HMAC-SHA256 –≤ –∫–∞—á–µ—Å—Ç–≤–µ –ø—Å–µ–≤–¥–æ—Å–ª—É—á–∞–π–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–∏
- **–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ**: –ü–æ–ª–Ω–æ–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ —Å Python `hashlib.pbkdf2_hmac()`

### –ò–µ—Ä–∞—Ä—Ö–∏—è –∫–ª—é—á–µ–π:
- **–û—Å–Ω–æ–≤–∞**: HMAC-based KDF (HKDF-—Å—Ç–∏–ª—å)
- **–î–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ—Å—Ç—å**: DeriveKey(master_key, context, length)
- **–£–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç—å**: –†–∞–∑–Ω—ã–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç—ã ‚Üí —Ä–∞–∑–Ω—ã–µ –∫–ª—é—á–∏
- **–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ**: –í—ã—Ä–∞–±–æ—Ç–∫–∞ encryption_key, mac_key, iv_key –∏–∑ –º–∞—Å—Ç–µ—Ä-–∫–ª—é—á–∞

### –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–æ–ª–∏:
- **–†–∞–∑–º–µ—Ä**: 16 –±–∞–π—Ç (—Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–æ)
- **–ò—Å—Ç–æ—á–Ω–∏–∫**: –ö—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω—ã–π –ì–°–ß (`crypto/rand`)
- **–£–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç—å**: 100 —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Å–æ–ª–µ–π ‚Üí 100 —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π
- **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å**: –ó–∞—â–∏—Ç–∞ –æ—Ç rainbow table –∞—Ç–∞–∫

## –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### –ê–ª–≥–æ—Ä–∏—Ç–º: AES-128
- –†–∞–∑–º–µ—Ä –±–ª–æ–∫–∞: 16 –±–∞–π—Ç
- –†–∞–∑–º–µ—Ä –∫–ª—é—á–∞: 16 –±–∞–π—Ç (128 –±–∏—Ç)
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–∞—É–Ω–¥–æ–≤: 10

### –ö—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω—ã–π –ì–°–ß
- –î–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∫–ª—é—á–µ–π, IV –∏ —Å–æ–ª–µ–π –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏ —Å—Ç–æ–π–∫–∏–π –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä —Å–ª—É—á–∞–π–Ω—ã—Ö —á–∏—Å–µ–ª
- –û—Å–Ω–æ–≤–∞–Ω –Ω–∞ —Å–∏—Å—Ç–µ–º–Ω–æ–º –∏—Å—Ç–æ—á–Ω–∏–∫–µ —ç–Ω—Ç—Ä–æ–ø–∏–∏ (`crypto/rand`)
- –ì–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç—å –∏ –Ω–µ–ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–æ—Å—Ç—å –≥–µ–Ω–µ—Ä–∏—Ä—É–µ–º—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π
- –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∞–º –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–æ–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

### Padding: PKCS#7
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –±–∞–π—Ç–æ–≤ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è –¥–ª—è ECB –∏ CBC
- –†–∞–∑–º–µ—Ä padding: –æ—Ç 1 –¥–æ 16 –±–∞–π—Ç
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ –ø—Ä–∏ –¥–µ—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–∏
- –ü–æ—Ç–æ–∫–æ–≤—ã–µ —Ä–µ–∂–∏–º—ã (CFB, OFB, CTR, GCM) –Ω–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç padding

### –§–æ—Ä–º–∞—Ç –∫–ª—é—á–∞ –∏ IV
- –ö–ª—é—á: 32 —Å–∏–º–≤–æ–ª–∞ –≤ —à–µ—Å—Ç–Ω–∞–¥—Ü–∞—Ç–µ—Ä–∏—á–Ω–æ–º —Ñ–æ—Ä–º–∞—Ç–µ (16 –±–∞–π—Ç)
- –ö–ª—é—á ETM: 96 —Å–∏–º–≤–æ–ª–æ–≤ –≤ —à–µ—Å—Ç–Ω–∞–¥—Ü–∞—Ç–µ—Ä–∏—á–Ω–æ–º —Ñ–æ—Ä–º–∞—Ç–µ (48 –±–∞–π—Ç)
- IV: 32 —Å–∏–º–≤–æ–ª–∞ –≤ —à–µ—Å—Ç–Ω–∞–¥—Ü–∞—Ç–µ—Ä–∏—á–Ω–æ–º —Ñ–æ—Ä–º–∞—Ç–µ (16 –±–∞–π—Ç)
- Nonce (GCM): 24 —Å–∏–º–≤–æ–ª–∞ –≤ —à–µ—Å—Ç–Ω–∞–¥—Ü–∞—Ç–µ—Ä–∏—á–Ω–æ–º —Ñ–æ—Ä–º–∞—Ç–µ (12 –±–∞–π—Ç)
- –ü—Ä–∏–º–µ—Ä –∫–ª—é—á–∞: `000102030405060708090a0b0c0d0e0f`
- –ü—Ä–∏–º–µ—Ä IV: `aabbccddeeff00112233445566778899`
- –ü—Ä–∏–º–µ—Ä nonce: `aabbccddeeff001122334455`

## –§–æ—Ä–º–∞—Ç—ã —Ñ–∞–π–ª–æ–≤ AEAD

### GCM —Ñ–æ—Ä–º–∞—Ç:
```
[12 –±–∞–π—Ç nonce][—à–∏—Ñ—Ä–æ—Ç–µ–∫—Å—Ç][16 –±–∞–π—Ç —Ç–µ–≥ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏]
```

### Encrypt-then-MAC —Ñ–æ—Ä–º–∞—Ç (–¥–ª—è —Ä–µ–∂–∏–º–æ–≤ —Å IV):
```
[16 –±–∞–π—Ç IV][—à–∏—Ñ—Ä–æ—Ç–µ–∫—Å—Ç][32 –±–∞–π—Ç HMAC-SHA256 —Ç–µ–≥]
```

### Encrypt-then-MAC —Ñ–æ—Ä–º–∞—Ç (ECB):
```
[—à–∏—Ñ—Ä–æ—Ç–µ–∫—Å—Ç][32 –±–∞–π—Ç HMAC-SHA256 —Ç–µ–≥]
```

### –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ —Ä–µ–∂–∏–º—ã —Å IV:
```
[16 –±–∞–π—Ç IV][–¥–∞–Ω–Ω—ã–µ —à–∏—Ñ—Ä–æ—Ç–µ–∫—Å—Ç–∞]
```

### ECB (–±–µ–∑ IV):
```
[–¥–∞–Ω–Ω—ã–µ —à–∏—Ñ—Ä–æ—Ç–µ–∫—Å—Ç–∞]
```

## –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ü—Ä–∏–º–µ—Ä 1: –ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å Encrypt-then-MAC
```bash
# 48-–±–∞–π—Ç–Ω—ã–π –∫–ª—é—á –¥–ª—è ETM
ETM_KEY="00112233445566778899aabbccddeeff0102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1fff"

# –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
./cryptocore --algorithm aes --mode ctr --encrypt \
  --key $ETM_KEY \
  --input database_backup.sql --output backup.etm \
  --aad "db_name:production|backup_type:full|encrypted_at:$(date -Iseconds)"

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏ –ø–µ—Ä–µ–¥ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ–º
./cryptocore --algorithm aes --mode ctr --decrypt \
  --key $ETM_KEY \
  --input backup.etm --output /dev/null \
  --aad "db_name:production|backup_type:full|encrypted_at:2024-12-19T10:30:00Z"
```

### –ü—Ä–∏–º–µ—Ä 2: –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –ø–æ–¥–¥–µ–ª–∫–∏ –¥–∞–Ω–Ω—ã—Ö
```bash
# –°–æ–∑–¥–∞–µ–º –ø–æ–¥–ø–∏—Å–∞–Ω–Ω—ã–π —Ñ–∞–π–ª
./cryptocore --algorithm aes --mode gcm --encrypt \
  --key 000102030405060708090a0b0c0d0e0f \
  --input firmware.bin --output firmware_signed.gcm

# –ó–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫ –∏–∑–º–µ–Ω—è–µ—Ç —Ñ–∞–π–ª
dd if=/dev/urandom of=firmware_tampered.gcm bs=1 count=1 seek=50 conv=notrunc

# –ü–æ–ø—ã—Ç–∫–∞ –¥–µ—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–æ–≤–∞–ª–∏–≤–∞–µ—Ç—Å—è
./cryptocore --algorithm aes --mode gcm --decrypt \
  --key 000102030405060708090a0b0c0d0e0f \
  --input firmware_tampered.gcm --output firmware.bin
# –í—ã–≤–æ–¥: Error: –æ—à–∏–±–∫–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ GCM: –æ—à–∏–±–∫–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏: –Ω–µ–≤–µ—Ä–Ω—ã–π —Ç–µ–≥
```

### –ü—Ä–∏–º–µ—Ä 3: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏ —Ñ–∞–π–ª–æ–≤ —Å HMAC
```bash
# –í—ã—á–∏—Å–ª—è–µ–º HMAC –ø–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π
./cryptocore dgst --algorithm sha256 --hmac --key —Å–µ–∫—Ä–µ—Ç–Ω—ã–π_–∫–ª—é—á --input important_file.iso --output file_auth.hmac

# –ü–æ–ª—É—á–∞—Ç–µ–ª—å –ø—Ä–æ–≤–µ—Ä—è–µ—Ç HMAC
./cryptocore dgst --algorithm sha256 --hmac --key —Å–µ–∫—Ä–µ—Ç–Ω—ã–π_–∫–ª—é—á --input important_file.iso --verify file_auth.hmac
# –í—ã–≤–æ–¥: [OK] HMAC verification successful (–µ—Å–ª–∏ —Ñ–∞–π–ª –Ω–µ –∏–∑–º–µ–Ω–µ–Ω)
```

### –ü—Ä–∏–º–µ—Ä 4: –í—ã—Ä–∞–±–æ—Ç–∫–∞ –∫–ª—é—á–∞ –¥–ª—è —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è
```bash
# –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –∫–ª—é—á –∏–∑ –ø–∞—Ä–æ–ª—è
./cryptocore derive --password "MyDatabasePassword!" \
  --salt "deadbeefcafebabe0123456789abcdef" \
  --iterations 100000 \
  --length 32 \
  --output db_encryption_key.bin

# –ò—Å–ø–æ–ª—å–∑—É–µ–º –≤—ã–≤–µ–¥–µ–Ω–Ω—ã–π –∫–ª—é—á –¥–ª—è —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è
DB_KEY=$(head -c 64 db_encryption_key.bin)  # –ü–µ—Ä–≤—ã–µ 32 –±–∞–π—Ç–∞ –≤ hex
./cryptocore --algorithm aes --mode gcm --encrypt \
  --key $DB_KEY \
  --input sensitive_data.db --output encrypted_data.gcm
```

### –ü—Ä–∏–º–µ—Ä 5: –ò–µ—Ä–∞—Ä—Ö–∏—è –∫–ª—é—á–µ–π –¥–ª—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
```bash
# –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –º–∞—Å—Ç–µ—Ä-–∫–ª—é—á
MASTER_KEY=$(openssl rand -hex 32)

```

### –ü—Ä–∏–º–µ—Ä 6: –†–∞–±–æ—Ç–∞ —Å —Ä–∞–∑–Ω—ã–º–∏ —Ä–µ–∂–∏–º–∞–º–∏
```bash
# –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –≤ —Ä–µ–∂–∏–º–µ CFB
./cryptocore --algorithm aes --mode cfb --encrypt \
  --key 000102030405060708090a0b0c0d0e0f \
  --input secret.txt --output data_cfb.enc

# –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –≤ —Ä–µ–∂–∏–º–µ CTR
./cryptocore --algorithm aes --mode ctr --encrypt \
  --key 000102030405060708090a0b0c0d0e0f \
  --input secret.txt --output data_ctr.enc
```

### –ü—Ä–∏–º–µ—Ä 7: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –∏–º–µ–Ω–∞ —Ñ–∞–π–ª–æ–≤
```bash
# –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º –∏–º–µ–Ω–µ–º —Ñ–∞–π–ª–∞ (—Å–æ–∑–¥–∞—Å—Ç secret_cbc.enc)
./cryptocore --algorithm aes --mode cbc --encrypt \
  --key 000102030405060708090a0b0c0d0e0f \
  --input secret.txt

# –î–µ—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º –∏–º–µ–Ω–µ–º —Ñ–∞–π–ª–∞ (—Å–æ–∑–¥–∞—Å—Ç secret.dec)
./cryptocore --algorithm aes --mode cbc --decrypt \
  --key 000102030405060708090a0b0c0d0e0f \
  --input secret_cbc.enc
```

### –ü—Ä–∏–º–µ—Ä 8: –†–∞–±–æ—Ç–∞ —Å –±–∏–Ω–∞—Ä–Ω—ã–º–∏ —Ñ–∞–π–ª–∞–º–∏
```bash
# –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –±–∏–Ω–∞—Ä–Ω–æ–≥–æ —Ñ–∞–π–ª–∞ –≤ —Ä–µ–∂–∏–º–µ OFB
./cryptocore --algorithm aes --mode ofb --encrypt \
  --key 000102030405060708090a0b0c0d0e0f \
  --input image.jpg --output image_encrypted.bin

# –î–µ—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –æ–±—Ä–∞—Ç–Ω–æ
./cryptocore --algorithm aes --mode ofb --decrypt \
  --key 000102030405060708090a0b0c0d0e0f \
  --input image_encrypted.bin --output image_restored.jpg
```

## –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å OpenSSL

### CryptoCore -> OpenSSL (—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ —Ä–µ–∂–∏–º—ã):
```bash
# –®–∏—Ñ—Ä—É–µ–º —Ñ–∞–π–ª —Å –ø–æ–º–æ—â—å—é CryptoCore
./cryptocore --algorithm aes --mode cbc --encrypt \
  --key 000102030405060708090a0b0c0d0e0f \
  --input plaintext.txt --output ciphertext.bin

# –ò–∑–≤–ª–µ–∫–∞–µ–º IV (–ø–µ—Ä–≤—ã–µ 16 –±–∞–π—Ç) –∏ —à–∏—Ñ—Ä–æ—Ç–µ–∫—Å—Ç
dd if=ciphertext.bin of=iv.bin bs=16 count=1
dd if=ciphertext.bin of=ciphertext_only.bin bs=16 skip=1

# –î–µ—à–∏—Ñ—Ä—É–µ–º —Å –ø–æ–º–æ—â—å—é OpenSSL
openssl enc -aes-128-cbc -d \
  -K 000102030405060708090A0B0C0D0E0F \
  -iv $(xxd -p iv.bin | tr -d '\n') \
  -in ciphertext_only.bin \
  -out openssl_decrypted.txt
```

### OpenSSL -> CryptoCore (—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ —Ä–µ–∂–∏–º—ã):
```bash
# –®–∏—Ñ—Ä—É–µ–º —Ñ–∞–π–ª —Å –ø–æ–º–æ—â—å—é OpenSSL
openssl enc -aes-128-cbc \
  -K 000102030405060708090A0B0C0D0E0F \
  -iv AABBCCDDEEFF00112233445566778899 \
  -in secret.txt \
  -out openssl_ciphertext.bin

# –î–µ—à–∏—Ñ—Ä—É–µ–º —Å –ø–æ–º–æ—â—å—é CryptoCore
./cryptocore --algorithm aes --mode cbc --decrypt \
  --key 000102030405060708090a0b0c0d0e0f \
  --iv AABBCCDDEEFF00112233445566778899 \
  --input openssl_ciphertext.bin \
  --output cryptocore_decrypted.txt
```

### –ö–æ–º–∞–Ω–¥—ã OpenSSL –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ä–µ–∂–∏–º–∞

| –†–µ–∂–∏–º | –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ OpenSSL | –î–µ—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ OpenSSL |
|-------|-------------------|---------------------|
| ECB | `openssl enc -aes-128-ecb -K <key> -in <input> -out <output>` | `openssl enc -aes-128-ecb -d -K <key> -in <input> -out <output>` |
| CBC | `openssl enc -aes-128-cbc -K <key> -iv <iv> -in <input> -out <output>` | `openssl enc -aes-128-cbc -d -K <key> -iv <iv> -in <input> -out <output>` |
| CFB | `openssl enc -aes-128-cfb -K <key> -iv <iv> -in <input> -out <output>` | `openssl enc -aes-128-cfb -d -K <key> -iv <iv> -in <input> -out <output>` |
| OFB | `openssl enc -aes-128-ofb -K <key> -iv <iv> -in <input> -out <output>` | `openssl enc -aes-128-ofb -d -K <key> -iv <iv> -in <input> -out <output>` |
| CTR | `openssl enc -aes-128-ctr -K <key> -iv <iv> -in <input> -out <output>` | `openssl enc -aes-128-ctr -d -K <key> -iv <iv> -in <input> -out <output>` |

### –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è –∏ HMAC

```bash
# –ù–∞—à–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è SHA-256
./cryptocore dgst --algorithm sha256 --input file.txt

# –°–∏—Å—Ç–µ–º–Ω–∞—è —É—Ç–∏–ª–∏—Ç–∞
sha256sum file.txt  # Linux/Mac
certutil -hashfile file.txt SHA256  # Windows

# –ù–∞—à–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è SHA3-256  
./cryptocore dgst --algorithm sha3-256 --input file.txt

# –°–∏—Å—Ç–µ–º–Ω–∞—è —É—Ç–∏–ª–∏—Ç–∞
sha3sum -a 256 file.txt  # Linux/Mac

# –ù–∞—à–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è HMAC-SHA-256
./cryptocore dgst --algorithm sha256 --hmac --key 00112233445566778899aabbccddeeff --input file.txt

# OpenSSL HMAC
openssl dgst -sha256 -hmac 00112233445566778899aabbccddeeff file.txt
```

### –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å PBKDF2

```bash
# –ù–∞—à–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è PBKDF2-HMAC-SHA256
./cryptocore derive --password "test" \
  --salt 1234567890abcdef \
  --iterations 1000 \
  --length 32

# Python hashlib (—ç—Ç–∞–ª–æ–Ω)
python3 -c "
import hashlib, binascii
dk = hashlib.pbkdf2_hmac('sha256', b'test', 
                         binascii.unhexlify('1234567890abcdef'), 
                         1000, dklen=32)
print(binascii.hexlify(dk).decode())
"
# –†–µ–∑—É–ª—å—Ç–∞—Ç –¥–æ–ª–∂–µ–Ω —Å–æ–≤–ø–∞–¥–∞—Ç—å: 4cd8b5c46aee47f0d4a6a0dd7c205b1d30b54d2503c13fe7422e95ea312b7425
```

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

CryptoCore –≤–∫–ª—é—á–∞–µ—Ç —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—É—é —Å–∏—Å—Ç–µ–º—É —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ KDF —Ñ—É–Ω–∫—Ü–∏–π:
```bash
cd tests

# –ö–æ–º–ø–ª–µ–∫—Å–Ω—ã–µ —Ç–µ—Å—Ç—ã PBKDF2
go run test_pbkdf2_vectors.go

# –í—Å–µ KDF —Ç–µ—Å—Ç—ã
go run test_kdf_comprehensive.go
```

**–¢–µ—Å—Ç—ã KDF –≤–∫–ª—é—á–∞—é—Ç:**
- –î–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ—Å—Ç—å PBKDF2 (1000+ —Ç–µ—Å—Ç–æ–≤)
- –†–∞–∑–ª–∏—á–Ω—ã–µ –¥–ª–∏–Ω—ã –∫–ª—é—á–µ–π (1-128 –±–∞–π—Ç)
- –£–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç—å —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Å–æ–ª–µ–π (100 —Å–æ–ª–µ–π)
- –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –∫–ª—é—á–µ–π –ø–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞–º (5+ –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–≤)
- –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å (1000-50000 –∏—Ç–µ—Ä–∞—Ü–∏–π)
- –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å Python hashlib (–ø–æ–ª–Ω–æ–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ)
- RFC 6070 —Ç–µ—Å—Ç–æ–≤—ã–µ –≤–µ–∫—Ç–æ—Ä—ã (–∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–ª—è SHA-256)

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ GCM –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏:
```bash
cd tests
go run test_gcm_security.go
```

**–¢–µ—Å—Ç—ã –≤–∫–ª—é—á–∞—é—Ç:**
- –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –ø–æ–¥–¥–µ–ª–∫–∏ —à–∏—Ñ—Ä–æ—Ç–µ–∫—Å—Ç–∞
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ —Å AAD
- –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –ø–æ–¥–¥–µ–ª–∫–∏ —Ç–µ–≥–∞
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø—É—Å—Ç—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
- –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è nonce

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ Encrypt-then-MAC –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏:
```bash
cd tests
go run test_etm_security.go
```

**–¢–µ—Å—Ç—ã –≤–∫–ª—é—á–∞—é—Ç:**
- –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è —Å AAD
- –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –ø–æ–¥–¥–µ–ª–∫–∏ –¥–∞–Ω–Ω—ã—Ö
- –†–∞–±–æ—Ç–∞ –≤–æ –≤—Å–µ—Ö —Ä–µ–∂–∏–º–∞—Ö (CBC, CTR, CFB, OFB)
- –ß—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∫ –∫–ª—é—á–∞–º
- –í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è –ø–µ—Ä–µ–¥ –¥–µ—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ–º
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø—É—Å—Ç—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π

### –ú–æ–¥—É–ª—å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ CSPRNG

```bash
# –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Ç–µ—Å—Ç–æ–≤ –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–æ–≥–æ –ì–°–ß
cd tests
go run test_csprng.go
```

**–¢–µ—Å—Ç–æ–≤–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ –≤–∫–ª—é—á–∞–µ—Ç:**
- –£–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç—å —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∫–ª—é—á–µ–π (1000+ –∫–ª—é—á–µ–π)
- –°—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –±–∏—Ç–æ–≤ (—ç–Ω—Ç—Ä–æ–ø–∏—è ~50%)
- –ö–æ—Ä—Ä–µ–∫—Ç–Ω—É—é –≥–µ–Ω–µ—Ä–∞—Ü–∏—é –¥–∞–Ω–Ω—ã—Ö —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Ä–∞–∑–º–µ—Ä–æ–≤
- –û–±—Ä–∞–±–æ—Ç–∫—É –≥—Ä–∞–Ω–∏—á–Ω—ã—Ö —Å–ª—É—á–∞–µ–≤ –∏ –æ—à–∏–±–æ–∫
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é —Å –æ—Å–Ω–æ–≤–Ω–æ–π —É—Ç–∏–ª–∏—Ç–æ–π

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ HMAC

–í—Å–µ —Ç–µ—Å—Ç–æ–≤—ã–µ –≤–µ–∫—Ç–æ—Ä—ã —É—Å–ø–µ—à–Ω–æ –ø—Ä–æ–π–¥–µ–Ω—ã —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–µ–π:

**–¢–µ—Å—Ç 1: Basic HMAC with 20-byte key**
```bash
echo -n "Hi There" > test1.txt
./cryptocore dgst --algorithm sha256 --hmac --key 0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b --input test1.txt
# –û–∂–∏–¥–∞–µ–º—ã–π –≤—ã–≤–æ–¥: b0344c61d8db38535ca8afceaf0bf12b881dc200c9833da726e9376c2e32cff7  test1.txt
```

**–¢–µ—Å—Ç 2: HMAC with ASCII key ("Jefe")**
```bash
echo -n "what do ya want for nothing?" > test2.txt
./cryptocore dgst --algorithm sha256 --hmac --key 4a656665 --input test2.txt
# –û–∂–∏–¥–∞–µ–º—ã–π –≤—ã–≤–æ–¥: 5bdcc146bf60754e6a042426089575c75a003f089d2739839dec58b964ec3843  test2.txt
```

**–¢–µ—Å—Ç 3: HMAC with binary data (50 bytes 0xdd)**
```bash
python -c "open('test3.bin', 'wb').write(b'\xdd' * 50)"
./cryptocore dgst --algorithm sha256 --hmac --key aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa --input test3.bin
# –û–∂–∏–¥–∞–µ–º—ã–π –≤—ã–≤–æ–¥: 773ea91e36800e46854db8ebd09181a72959098b3ef8c122d9635514ced565fe  test3.bin
```

**–¢–µ—Å—Ç 4: HMAC with 25-byte incremental key**
```bash
python -c "open('test4.bin', 'wb').write(b'\xcd' * 50)"
./cryptocore dgst --algorithm sha256 --hmac --key 0102030405060708090a0b0c0d0e0f10111213141516171819 --input test4.bin
# –û–∂–∏–¥–∞–µ–º—ã–π –≤—ã–≤–æ–¥: 82558a389a443c0ea4cc819899f2083a85f0faa3e578f8077a2e3ff46729665b  test4.bin
```

**–ö–æ—Ä–æ—Ç–∫–∏–π –∫–ª—é—á (1 –±–∞–π—Ç)**
```bash
echo "Test" > short_key.txt
./cryptocore dgst --algorithm sha256 --hmac --key 01 --input short_key.txt
# –†–µ–∑—É–ª—å—Ç–∞—Ç: 29509a96fbdc60371d82e416af5cef88d095af2bd303987588ba4d32f2810a49  short_key.txt
```

**–î–ª–∏–Ω–Ω—ã–π –∫–ª—é—á (100 –±–∞–π—Ç)**
```bash
echo "Test" > long_key.txt
./cryptocore dgst --algorithm sha256 --hmac --key $(python -c "print('22' * 100)") --input long_key.txt
# –†–µ–∑—É–ª—å—Ç–∞—Ç: 3c8f1c3a84cc99562789c71cc05022f8c9e39b2ec7e18a416e7f6ab45a38d802  long_key.txt
```

**–ü—É—Å—Ç–æ–π —Ñ–∞–π–ª**
```bash
echo -n "" > empty.txt
./cryptocore dgst --algorithm sha256 --hmac --key 00112233445566778899aabbccddeeff --input empty.txt
# –†–µ–∑—É–ª—å—Ç–∞—Ç: 81482a2844d68464f2354eb65632aa95e0fee94a0dca9aec471238434a4c4bdb  empty.txt
```

**–û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ —Ñ–∞–π–ª–µ**
```bash
echo "Original content" > file.txt
./cryptocore dgst --algorithm sha256 --hmac --key 00112233445566778899aabbccddeeff --input file.txt --output original.hmac
echo "Modified content" > file.txt
./cryptocore dgst --algorithm sha256 --hmac --key 00112233445566778899aabbccddeeff --input file.txt --verify original.hmac
# –û–∂–∏–¥–∞–µ–º—ã–π –≤—ã–≤–æ–¥: Error: HMAC verification failed
```

**–û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –∫–ª—é—á–∞**
```bash
echo "Test message" > message.txt
./cryptocore dgst --algorithm sha256 --hmac --key 00112233445566778899aabbccddeeff --input message.txt --output correct.hmac
./cryptocore dgst --algorithm sha256 --hmac --key ffeeddccbbaa99887766554433221100 --input message.txt --verify correct.hmac
# –û–∂–∏–¥–∞–µ–º—ã–π –≤—ã–≤–æ–¥: Error: HMAC verification failed
```

**–£—Å–ø–µ—à–Ω–∞—è –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è**
```bash
echo "Test message" > verify.txt
./cryptocore dgst --algorithm sha256 --hmac --key 00112233445566778899aabbccddeeff --input verify.txt --output verify.hmac
./cryptocore dgst --algorithm sha256 --hmac --key 00112233445566778899aabbccddeeff --input verify.txt --verify verify.hmac
# –û–∂–∏–¥–∞–µ–º—ã–π –≤—ã–≤–æ–¥: [OK] HMAC verification successful
```

### NIST Statistical Test Suite

–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä —Å–ª—É—á–∞–π–Ω—ã—Ö —á–∏—Å–µ–ª —É—Å–ø–µ—à–Ω–æ –ø—Ä–æ—à–µ–ª –ø–æ–ª–Ω—É—é –±–∞—Ç–∞—Ä–µ—é —Ç–µ—Å—Ç–æ–≤ NIST STS:
- **15 —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏—Ö —Ç–µ—Å—Ç–æ–≤** + 148 —à–∞–±–ª–æ–Ω–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤
- **–û–±—ä–µ–º –¥–∞–Ω–Ω—ã—Ö**: 10 MB —Å–ª—É—á–∞–π–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö  
- **–†–µ–∑—É–ª—å—Ç–∞—Ç**: 163/163 —Ç–µ—Å—Ç–æ–≤ —É—Å–ø–µ—à–Ω–æ –ø—Ä–æ–π–¥–µ–Ω—ã
- **–ö–∞—á–µ—Å—Ç–≤–æ**: –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∞–º –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–æ–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞ (–æ–±–Ω–æ–≤–ª–µ–Ω–Ω–∞—è)

```
CryptoCore/
‚îú‚îÄ‚îÄ src/                      # –ò—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥
‚îÇ   ‚îú‚îÄ‚îÄ main.go              # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞
‚îÇ   ‚îú‚îÄ‚îÄ cli_parser.go        # –ü–∞—Ä—Å–∏–Ω–≥ –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ file_io.go           # –†–∞–±–æ—Ç–∞ —Å —Ñ–∞–π–ª–∞–º–∏ –∏ IV
‚îÇ   ‚îú‚îÄ‚îÄ kdf/                 # –§—É–Ω–∫—Ü–∏–∏ –≤—ã—Ä–∞–±–æ—Ç–∫–∏ –∫–ª—é—á–µ–π
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ pbkdf2.go        # PBKDF2-HMAC-SHA256 —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ hkdf.go          # HKDF –∏ –∏–µ—Ä–∞—Ä—Ö–∏—è –∫–ª—é—á–µ–π
‚îÇ   ‚îú‚îÄ‚îÄ csprng/              # –ö—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω—ã–π –ì–°–ß
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ csprng.go        # –†–µ–∞–ª–∏–∑–∞—Ü–∏—è CSPRNG
‚îÇ   ‚îú‚îÄ‚îÄ aead/                # AEAD —Ä–µ–∂–∏–º—ã
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ gcm.go           # –†–µ–∂–∏–º GCM
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ encrypt_then_mac.go  # Encrypt-then-MAC –ø–∞—Ä–∞–¥–∏–≥–º–∞
‚îÇ   ‚îú‚îÄ‚îÄ hash/                # –†–µ–∞–ª–∏–∑–∞—Ü–∏–∏ —Ö–µ—à-—Ñ—É–Ω–∫—Ü–∏–π
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ common.go        # –û–±—â–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ sha256.go        # SHA-256
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ sha3.go          # SHA3-256
‚îÇ   ‚îú‚îÄ‚îÄ modes/               # –†–µ–∞–ª–∏–∑–∞—Ü–∏–∏ —Ä–µ–∂–∏–º–æ–≤ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ common.go        # –û–±—â–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ecb.go           # –†–µ–∂–∏–º ECB
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ cbc.go           # –†–µ–∂–∏–º CBC
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ cfb.go           # –†–µ–∂–∏–º CFB
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ofb.go           # –†–µ–∂–∏–º OFB
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ ctr.go           # –†–µ–∂–∏–º CTR
‚îÇ   ‚îî‚îÄ‚îÄ mac/                 # –†–µ–∞–ª–∏–∑–∞—Ü–∏–∏ MAC —Ñ—É–Ω–∫—Ü–∏–π
‚îÇ       ‚îî‚îÄ‚îÄ hmac.go          # HMAC-SHA-256
‚îú‚îÄ‚îÄ tests/                   # –¢–µ—Å—Ç—ã
‚îÇ   ‚îú‚îÄ‚îÄ test_pbkdf2_vectors.go     # –¢–µ—Å—Ç—ã PBKDF2 —Å –≤–µ–∫—Ç–æ—Ä–∞–º–∏
‚îÇ   ‚îú‚îÄ‚îÄ test_kdf_comprehensive.go  # –ö–æ–º–ø–ª–µ–∫—Å–Ω—ã–µ —Ç–µ—Å—Ç—ã KDF
‚îÇ   ‚îú‚îÄ‚îÄ test_csprng.go       # –¢–µ—Å—Ç—ã –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–æ–≥–æ –ì–°–ß
‚îÇ   ‚îú‚îÄ‚îÄ test_gcm_security.go # –¢–µ—Å—Ç—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ GCM
‚îÇ   ‚îî‚îÄ‚îÄ test_etm_security.go # –¢–µ—Å—Ç—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ Encrypt-then-MAC
‚îú‚îÄ‚îÄ Makefile                 # –°–∏—Å—Ç–µ–º–∞ —Å–±–æ—Ä–∫–∏
‚îú‚îÄ‚îÄ go.mod                   # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ Go
‚îî‚îÄ‚îÄ README.md               # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
```
